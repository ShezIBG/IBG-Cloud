<ng-container *ngIf="list">
	<div class="card-box">
		<div class="row">
			<div class="col-md-6">
				<div class="input-group">
					<span class="input-group-addon"><i class="md md-search"></i></span>
					<input type="text" class="form-control" placeholder="Search" [(ngModel)]="search">
				</div>
			</div>
			<div class="col-md-6">
				<a class="btn btn-primary pull-right" routerLink="new"><i class="md md-add"></i> New invoicing entity</a>
			</div>
			<div class="col-md-12">
				<hr>
				<div class="form-inline">
					<div class="checkbox checkbox-primary">
						<label>
							<input type="checkbox" [(ngModel)]="billing.invoiceEntitiesWithActiveContracts" (ngModelChange)="refresh()">
							<span>Invoicing entities with active contracts only</span>
						</label>
					</div>
					<div class="checkbox checkbox-danger">
						<label>
							<input type="checkbox" [(ngModel)]="billing.showArchivedInvoiceEntities" (ngModelChange)="refresh()">
							<span>Show archived invoicing entities</span>
						</label>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="card-box text-info bg-info text-light">
		<p>
			<i class="md md-info"></i>
			Invoicing entities can be used to change the company details on the invoices generated by the system and can be customised per contract. These details are also shown on the customer's account page. <b>Make sure you only use one invoicing entity per customer.</b>
		</p>
		<p class="m-b-0">
			If you take payments through the portal, you may want to set up different payment gateways for each invoicing entity, as company details are also shown by the payment processor.
		</p>
	</div>

	<div class="card-box">
		<table class="table table-striped table-hover">
			<thead>
				<tr>
					<th class="shrink">#</th>
					<th>Logo</th>
					<th>Entity Name</th>
					<th>Address</th>
					<th>Bank Details</th>
					<th class="text-center">Contracts</th>
					<th class="shrink nowrap"></th>
				</tr>
			</thead>
			<tbody>
				<tr *ngFor="let item of list | keywords:search:['id', 'name', 'address_line_1', 'address_line_2', 'address_line_3', 'posttown', 'postcode', 'bank_name'] | count:count:'list'" [ngClass]="{ 'danger': item.archived }">
					<td class="shrink">{{item.id}}</td>
					<td>
						<div *ngIf="!item.image_url" class="text-muted">Default</div>
						<img *ngIf="item.image_url" src="{{item.image_url}}" style="max-width: 100px; max-height: 100px;">
					</td>
					<td>
						<div>{{item.name}}</div>
						<div *ngIf="item.vat_reg_number" class="subtitle">VAT reg: {{item.vat_reg_number}}</div>
					</td>
					<td>
						<div *ngIf="!item.address_line_1 && !item.address_line_2 && !item.address_line_3 && !item.posttown && !item.postcode" class="text-muted">Default</div>
						<div *ngIf="item.address_line_1">{{item.address_line_1}}</div>
						<div *ngIf="item.address_line_2">{{item.address_line_2}}</div>
						<div *ngIf="item.address_line_3">{{item.address_line_3}}</div>
						<div *ngIf="item.posttown">{{item.posttown}}</div>
						<div *ngIf="item.postcode">{{item.postcode}}</div>
					</td>
					<td>
						<div *ngIf="!item.bank_name && !item.bank_sort_code && !item.bank_account_number" class="text-muted">Not set</div>
						<ng-container *ngIf="item.bank_name || item.bank_sort_code || item.bank_account_number">
							<div>{{item.bank_name}}</div>
							<div>{{item.bank_sort_code | sortcode}}</div>
							<div>{{item.bank_account_number}}</div>
						</ng-container>
					</td>
					<td class="text-center">{{item.active_contract_count}}</td>
					<td class="shrink nowrap"><a [routerLink]="[item.id]"><i class="md md-edit"></i> Edit</a></td>
				</tr>
				<tr *ngIf="!count.list">
					<td *ngIf="!billing.showArchivedInvoiceEntities" colspan="11">No active invoicing entities found.</td>
					<td *ngIf="billing.showArchivedInvoiceEntities" colspan="11">No archived invoicing entities found.</td>
				</tr>
			</tbody>
		</table>
	</div>
</ng-container>
